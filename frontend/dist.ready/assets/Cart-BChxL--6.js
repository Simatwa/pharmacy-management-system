import{c as o,d as j,j as e,X as g,u as f,b,r as N,V as i,a as v}from"./index-CdQU1hlX.js";import{A as w}from"./arrow-left-BkWhqfxE.js";import{T as u,A as S}from"./trash-2-BQ7ILBjV.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=o("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=o("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=o("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);function M({amount:t,onClose:r,onConfirm:c}){const{profile:a}=j();return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"M-PESA Payment"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:e.jsx(g,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Amount to Pay:"}),e.jsxs("span",{className:"text-xl font-bold text-red-600",children:["KSh ",t.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Account Balance:"}),e.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:["KSh ",a==null?void 0:a.account_balance.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{children:"Pay via M-PESA:"})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg space-y-2",children:[e.jsx("p",{className:"font-medium",children:"Instructions:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Go to M-PESA menu"}),e.jsx("li",{children:'Select "Lipa na M-PESA"'}),e.jsx("li",{children:'Select "Pay Bill"'}),e.jsxs("li",{children:["Enter Business Number: ",e.jsx("span",{className:"font-bold",children:"000000"})]}),e.jsxs("li",{children:["Enter Account Number: ",e.jsx("span",{className:"font-bold",children:a==null?void 0:a.username})]}),e.jsxs("li",{children:["Enter Amount: ",e.jsxs("span",{className:"font-bold",children:["KSh ",t.toLocaleString()]})]}),e.jsx("li",{children:"Enter your M-PESA PIN"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Confirm Payment"})]})]})]})})})}function B(){const{items:t,removeItem:r,updateQuantity:c,clearCart:a,total:n}=f(),{profile:l}=j(),m=b(),[y,x]=N.useState(!1),h=async()=>{const s=n();if(!l){i.error("Please log in to checkout");return}if(l.account_balance<s){i.error("Insufficient balance. Please add funds to your account."),x(!0);return}try{for(const d of t)await v.post(`/v1/order/${d.id}`,{quantity:d.quantity});a(),i.success("Orders placed successfully!"),m("/orders")}catch(d){console.error("Failed to place orders:",d),i.error("Failed to place orders")}};return t.length===0?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[e.jsx(p,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Add some medicines to get started!"}),e.jsxs("button",{onClick:()=>m("/"),className:"bg-red-600 text-white px-6 py-3 rounded-md font-medium hover:bg-red-700 flex items-center space-x-2 mx-auto",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsx("span",{children:"Browse Medicines"})]})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Shopping Cart"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[t.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center py-6 border-b border-gray-200 last:border-0",children:[e.jsx("img",{src:s.picture,alt:s.name,className:"w-24 h-24 object-cover rounded-md"}),e.jsxs("div",{className:"flex-1 mt-4 sm:mt-0 sm:ml-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.category}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>r(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(u,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>c(s.id,Math.max(1,s.quantity-1)),className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(k,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>c(s.id,Math.min(s.stock,s.quantity+1)),className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(C,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 text-right",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["KSh ",(s.price*s.quantity).toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["KSh ",s.price.toLocaleString()," each"]})]})]},s.id)),e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-8",children:[l&&e.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Your Balance:"}),e.jsxs("span",{className:"text-lg font-semibold",children:["KSh ",l.account_balance.toLocaleString()]})]})}),e.jsxs("div",{className:"flex justify-between text-xl font-semibold text-gray-900",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["KSh ",n().toLocaleString()]})]}),l&&l.account_balance<n()&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(S,{className:"h-5 w-5 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Your account balance is insufficient for this purchase. Please add funds to your account using M-PESA."})]})}),e.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row justify-end space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:a,className:"px-6 py-3 border border-red-600 text-red-600 rounded-md font-medium hover:bg-red-50 flex items-center justify-center space-x-2",children:[e.jsx(u,{className:"h-5 w-5"}),e.jsx("span",{children:"Clear Cart"})]}),e.jsxs("button",{onClick:h,className:"px-6 py-3 bg-red-600 text-white rounded-md font-medium hover:bg-red-700 flex items-center justify-center space-x-2",children:[e.jsx(p,{className:"h-5 w-5"}),e.jsx("span",{children:"Checkout"})]})]})]})]}),y&&e.jsx(M,{amount:n(),onClose:()=>x(!1),onConfirm:()=>{x(!1),h()}})]})}export{B as default};
